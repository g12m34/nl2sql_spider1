// Malloy semantic layer for: roller_coaster
// Full layer with ALL columns, primary keys, and joins
// Database: /workspace/spider_db/spider/database/roller_coaster/roller_coaster.sqlite

// country
source: country is duckdb.sql("""
  SELECT * FROM sqlite_scan('/workspace/spider_db/spider/database/roller_coaster/roller_coaster.sqlite', 'country')
""") extend {
  dimension:
    country_i_d is Country_ID
    name_val is `Name`

  primary_key: country_i_d

  measure:
    row_count is count()
    total_country_i_d is sum(country_i_d)
    avg_country_i_d is avg(country_i_d)
    max_country_i_d is max(country_i_d)
    min_country_i_d is min(country_i_d)
    total_population is sum(Population)
    avg_population is avg(Population)
    max_population is max(Population)
    min_population is min(Population)
    total_area is sum(Area)
    avg_area is avg(Area)
    max_area is max(Area)
    min_area is min(Area)
}

// roller_coaster
source: roller_coaster is duckdb.sql("""
  SELECT * FROM sqlite_scan('/workspace/spider_db/spider/database/roller_coaster/roller_coaster.sqlite', 'roller_coaster')
""") extend {
  dimension:
    roller_coaster_i_d is Roller_Coaster_ID
    name_val is `Name`
    country_i_d is Country_ID

  primary_key: roller_coaster_i_d

  join_one: country on country_i_d = country.country_i_d

  measure:
    row_count is count()
    total_roller_coaster_i_d is sum(roller_coaster_i_d)
    avg_roller_coaster_i_d is avg(roller_coaster_i_d)
    max_roller_coaster_i_d is max(roller_coaster_i_d)
    min_roller_coaster_i_d is min(roller_coaster_i_d)
    total_country_i_d is sum(country_i_d)
    avg_country_i_d is avg(country_i_d)
    max_country_i_d is max(country_i_d)
    min_country_i_d is min(country_i_d)
    total_length is sum(Length)
    avg_length is avg(Length)
    max_length is max(Length)
    min_length is min(Length)
    total_height is sum(Height)
    avg_height is avg(Height)
    max_height is max(Height)
    min_height is min(Height)
}
